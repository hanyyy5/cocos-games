{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\hero.js"],"names":["cc","Class","extends","Component","properties","blowupani","default","type","Prefab","tooltip","gameOverClip","AudioClip","main","require","bulletGroup","onLoad","eState","D","commonInfo","gameState","none","director","getCollisionManager","enabled","onDrag","node","on","dragMove","offDrag","off","event","locationv","getLocation","location","parent","convertToNodeSpaceAR","minX","width","maxX","minY","height","maxY","x","y","setPosition","onCollisionEnter","other","self","group","name","changeBullet","getUfoBomb","po","getPosition","blowup","instantiate","addChild","animation","getComponent","Animation","onFinished","audioEngine","playEffect","destroy","gameOver"],"mappings":";;;;;;AACAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAW;AAAA,eAAM;AACbC,uBAAW;AACPC,yBAAS,IADF;AAEPC,sBAAKP,GAAGQ,MAFD;AAGPC,yBAAS;AAHF,aADE;AAMbC,0BAAe;AACXH,sBAAMP,GAAGW,SADE;AAEXL,yBAAS;AAFE,aANF;AAUbM,kBAAM;AACFN,yBAAS,IADP;AAEFC,sBAAMM,QAAQ,MAAR;AAFJ,aAVO;AAcbC,yBAAa;AACTR,yBAAS,IADA;AAETC,sBAAMM,QAAQ,aAAR;AAFG;AAdA,SAAN;AAAA,KAHN;;AAuBL;AACAE,YAAQ,kBAAY;AAChB,aAAKC,MAAL,GAAcC,EAAEC,UAAF,CAAaC,SAAb,CAAuBC,IAArC;AACApB,WAAGqB,QAAH,CAAYC,mBAAZ,GAAkCC,OAAlC,GAA0C,IAA1C;AACA,aAAKC,MAAL;AACH,KA5BI;;AA8BL;AACAA,YAAQ,kBAAU;AACd,aAAKC,IAAL,CAAUC,EAAV,CAAa,WAAb,EAA0B,KAAKC,QAA/B,EAAyC,IAAzC;AACH,KAjCI;AAkCL;AACAC,aAAS,mBAAU;AACd,aAAKH,IAAL,CAAUI,GAAV,CAAc,WAAd,EAA2B,KAAKF,QAAhC,EAA0C,IAA1C;AACJ,KArCI;AAsCL;AACAA,cAAU,kBAASG,KAAT,EAAe;AACrB,YAAIC,YAAYD,MAAME,WAAN,EAAhB;AACA,YAAIC,WAAW,KAAKR,IAAL,CAAUS,MAAV,CAAiBC,oBAAjB,CAAsCJ,SAAtC,CAAf;AACA;AACA,YAAIK,OAAO,CAAC,KAAKX,IAAL,CAAUS,MAAV,CAAiBG,KAAlB,GAAwB,CAAxB,GAA0B,KAAKZ,IAAL,CAAUY,KAAV,GAAgB,CAArD;AACA,YAAIC,OAAO,CAACF,IAAZ;AACA,YAAIG,OAAO,CAAC,KAAKd,IAAL,CAAUS,MAAV,CAAiBM,MAAlB,GAAyB,CAAzB,GAA2B,KAAKf,IAAL,CAAUe,MAAV,GAAiB,CAAvD;AACA,YAAIC,OAAO,CAACF,IAAZ;AACA,YAAIN,SAASS,CAAT,GAAYN,IAAhB,EAAqB;AACjBH,qBAASS,CAAT,GAAaN,IAAb;AACH;AACD,YAAIH,SAASS,CAAT,GAAWJ,IAAf,EAAoB;AAChBL,qBAASS,CAAT,GAAaJ,IAAb;AACH;AACD,YAAIL,SAASU,CAAT,GAAYJ,IAAhB,EAAqB;AACjBN,qBAASU,CAAT,GAAaJ,IAAb;AACH;AACD,YAAIN,SAASU,CAAT,GAAYF,IAAhB,EAAqB;AACjBR,qBAASU,CAAT,GAAaF,IAAb;AACH;AACD,aAAKhB,IAAL,CAAUmB,WAAV,CAAsBX,QAAtB;AACH,KA5DI;AA6DL;AACAY,sBAAkB,0BAASC,KAAT,EAAeC,IAAf,EAAqB;AACnC,YAAID,MAAMrB,IAAN,CAAWuB,KAAX,IAAoB,KAAxB,EAA8B;AAC1B,gBAAIF,MAAMrB,IAAN,CAAWwB,IAAX,IAAmB,WAAvB,EAAmC;AAC/B,qBAAKnC,WAAL,CAAiBoC,YAAjB,CAA8BJ,MAAMrB,IAAN,CAAWwB,IAAzC;AACH,aAFD,MAEO,IAAIH,MAAMrB,IAAN,CAAWwB,IAAX,IAAmB,SAAvB,EAAiC;AACpC,qBAAKrC,IAAL,CAAUuC,UAAV;AACH;AACJ,SAND,MAMO,IAAIL,MAAMrB,IAAN,CAAWuB,KAAX,IAAoB,OAAxB,EAAgC;AACnC;AACA,gBAAII,KAAK,KAAK3B,IAAL,CAAU4B,WAAV,EAAT;AACA,gBAAIC,SAAStD,GAAGuD,WAAH,CAAe,KAAKlD,SAApB,CAAb;AACA,iBAAKoB,IAAL,CAAUS,MAAV,CAAiBsB,QAAjB,CAA0BF,MAA1B;AACAA,mBAAOV,WAAP,CAAmBQ,EAAnB;AACA,gBAAIK,YAAYH,OAAOI,YAAP,CAAoB1D,GAAG2D,SAAvB,CAAhB;AACAF,sBAAU/B,EAAV,CAAa,UAAb,EAA0B,KAAKkC,UAA/B,EAA2CN,MAA3C;AACA;AACAtD,eAAG6D,WAAH,CAAeC,UAAf,CAA0B,KAAKpD,YAA/B,EAA6C,KAA7C;AACA;AACA,iBAAKe,IAAL,CAAUsC,OAAV;AACA;AACA,iBAAKnD,IAAL,CAAUoD,QAAV;AACH,SAdM,MAcA;AACH,mBAAO,KAAP;AACH;AAEJ,KAvFI;;AAyFLJ,gBAAY,oBAAS9B,KAAT,EAAgB;AAAE;AAC1B,aAAKiC,OAAL;AACA;AAEH;AACD;AACA;;AAEA;AAjGK,CAAT","file":"hero.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties:()=> ({\r\n        blowupani: {\r\n            default: null,\r\n            type:cc.Prefab,\r\n            tooltip: '爆炸动画',\r\n        },\r\n        gameOverClip:  {\r\n            type: cc.AudioClip,\r\n            default: null\r\n        },\r\n        main: {\r\n            default: null,\r\n            type: require('main'),\r\n        },\r\n        bulletGroup: {\r\n            default: null,\r\n            type: require('bulletGroup'),\r\n        }\r\n    }),\r\n    \r\n    // use this for initialization\r\n    onLoad: function () {\r\n        this.eState = D.commonInfo.gameState.none;\r\n        cc.director.getCollisionManager().enabled=true;\r\n        this.onDrag();\r\n    },\r\n\r\n    //添加拖动监听\r\n    onDrag: function(){\r\n        this.node.on('touchmove', this.dragMove, this);\r\n    },\r\n    //去掉拖动监听\r\n    offDrag: function(){ \r\n         this.node.off('touchmove', this.dragMove, this);\r\n    },\r\n    //拖动\r\n    dragMove: function(event){ \r\n        var locationv = event.getLocation();\r\n        var location = this.node.parent.convertToNodeSpaceAR(locationv);\r\n        //飞机不移出屏幕 \r\n        var minX = -this.node.parent.width/2+this.node.width/2;\r\n        var maxX = -minX;\r\n        var minY = -this.node.parent.height/2+this.node.height/2;\r\n        var maxY = -minY;\r\n        if (location.x< minX){\r\n            location.x = minX;\r\n        }\r\n        if (location.x>maxX){\r\n            location.x = maxX;\r\n        }\r\n        if (location.y< minY){\r\n            location.y = minY;\r\n        }\r\n        if (location.y> maxY){\r\n            location.y = maxY;\r\n        }\r\n        this.node.setPosition(location);\r\n    },\r\n    //碰撞监测\r\n    onCollisionEnter: function(other,self) {\r\n        if (other.node.group == 'ufo'){\r\n            if (other.node.name == 'ufoBullet'){\r\n                this.bulletGroup.changeBullet(other.node.name);\r\n            } else if (other.node.name == 'ufoBomb'){\r\n                this.main.getUfoBomb();\r\n            }\r\n        } else if (other.node.group == 'enemy'){\r\n            //播放动画\r\n            var po = this.node.getPosition();\r\n            var blowup = cc.instantiate(this.blowupani);\r\n            this.node.parent.addChild(blowup);\r\n            blowup.setPosition(po);\r\n            var animation = blowup.getComponent(cc.Animation);\r\n            animation.on('finished',  this.onFinished, blowup);\r\n            //播放音效\r\n            cc.audioEngine.playEffect(this.gameOverClip, false);\r\n            //清除节点\r\n            this.node.destroy();\r\n            //更新分数 \r\n            this.main.gameOver();   \r\n        } else {\r\n            return false;\r\n        }\r\n        \r\n    },\r\n    \r\n    onFinished: function(event) { //动画结束后\r\n        this.destroy();\r\n        //cc.director.pause();\r\n        \r\n    },\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n\r\n    // },\r\n});\r\n"]}