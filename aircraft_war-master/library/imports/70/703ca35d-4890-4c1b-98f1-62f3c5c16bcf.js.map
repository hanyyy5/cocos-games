{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\enemyGroup.js"],"names":["enemyG","cc","Class","name","properties","freqTime","initPollCount","prefab","Prefab","extends","Component","default","type","main","require","onLoad","eState","D","commonInfo","gameState","none","common","batchInitObjPool","startAction","start","ei","length","fName","e","getNewEnemy","bind","schedule","resumeAction","enabled","pauseAction","pause","enemyInfo","poolName","newNode","genNewNode","node","newV2","getNewEnemyPositon","setPosition","getComponent","init","newEnemy","randx","Math","random","parent","width","randy","height","v2","enemyDied","nodeinfo","score","backObjPool","parseInt","gainScore","getScore"],"mappings":"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","file":"enemyGroup.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["\r\n//敌机组\r\nvar enemyG = cc.Class({\r\n    name:'enemyG',\r\n    properties: {\r\n        name:'',\r\n        freqTime:0,\r\n        initPollCount:0,\r\n        prefab:cc.Prefab\r\n    }\r\n});\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties:()=>({\r\n        enemyG: {\r\n            default:[],\r\n            type: enemyG\r\n        },\r\n        main: {\r\n            default: null,\r\n            type: require('main'),\r\n        },\r\n    }),\r\n    \r\n    // use this for initialization\r\n    onLoad: function () { \r\n        //初始化敌机组\r\n        this.eState = D.commonInfo.gameState.none;\r\n        D.common.batchInitObjPool(this,this.enemyG);\r\n    },\r\n    startAction: function(){\r\n        \r\n        this.eState = D.commonInfo.gameState.start;\r\n        //定时生成敌机\r\n        for (var ei=0; ei< this.enemyG.length; ++ei){\r\n            var freqTime = this.enemyG[ei].freqTime;\r\n            var fName = 'callback_'+ei;\r\n            this[fName] = function(e){ this.getNewEnemy(this.enemyG[e]); }.bind(this, ei);\r\n            this.schedule(this[fName], freqTime);\r\n        }\r\n    },\r\n    //重新开始\r\n    resumeAction: function(){\r\n        this.enabled = true;\r\n        this.eState = D.commonInfo.gameState.start;\r\n    },\r\n    //暂停\r\n    pauseAction: function(){\r\n        this.enabled = false;\r\n        this.eState = D.commonInfo.gameState.pause;\r\n        \r\n    },\r\n    //生成敌机\r\n    getNewEnemy: function(enemyInfo) {\r\n        var poolName = enemyInfo.name + 'Pool';\r\n        var newNode = D.common.genNewNode(this[poolName],enemyInfo.prefab,this.node);\r\n        var newV2 = this.getNewEnemyPositon(newNode);\r\n        newNode.setPosition(newV2);\r\n        newNode.getComponent('enemy').init();\r\n    },\r\n    //敌机随机生成的位置\r\n    getNewEnemyPositon: function(newEnemy) {\r\n        //位于上方，先不可见\r\n        // var randx = cc.randomMinus1To1()*(this.node.parent.width/2-newEnemy.width/2);\r\n        var randx = ((Math.random() - 0.5) * 2)*(this.node.parent.width/2-newEnemy.width/2);\r\n        var randy = this.node.parent.height/2+newEnemy.height/2;\r\n        return cc.v2(randx,randy);\r\n    },\r\n    enemyDied: function(nodeinfo,score){\r\n        //回收节点\r\n        D.common.backObjPool(this,nodeinfo);\r\n        //增加分数\r\n        if (parseInt(score)>0){\r\n            this.main.gainScore(score);\r\n        }  \r\n    },\r\n    getScore: function(){\r\n        return this.main.getScore();\r\n    },\r\n    // called every frame, uncomment this function to activate update callback\r\n    //update: function (dt) {\r\n        \r\n    //},\r\n    \r\n});\r\n"]}